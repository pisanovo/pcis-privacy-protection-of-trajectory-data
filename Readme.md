# Privacy Protection of trajectory data

This project contains multiple algorithms
that can anonymize car trajoctory data.

The data is generated by a carla instance and then
forwarded to the algorithm.
The result is visualized by a [NextJS frontend](git@github.com:pisanovo/carla-frontend.git).

TODO: Add more info here

## Usage

Because this project has many components, we use docker compose to run it.

### 1. Installation

1. Install docker and docker compose on your system. [docker.com](https://docker.com)
2. Install carla 0.9.14 on a powerful remote server, like the ipvs gpu server. Download the release [here](https://github.com/carla-simulator/carla/releases/tag/0.9.14/) and unzip it.
3. Clone the [frontend](git@github.com:pisanovo/carla-frontend.git). To set up a development environment for the frontend, follow the instructions in its readme.

### 2. Configuration

1. Copy the [example .env file](./.env.example) and fill it with your own values.
2. Create the secret files mentioned in the .env.example and note their location in the respective env variables:
- Create an ssh keypair and register it with the remote host that runs carla. If you don't know how to do that, [this](https://www.digitalocean.com/community/tutorials/how-to-use-ssh-to-connect-to-a-remote-server#how-to-log-into-ssh-with-keys) is a good place to start. Check the example file for further information
- Create a secret password file for the echo_agent db. This is just a `.txt` file with one line of text, that contains the password you would like to use.

### 3. Running

1. Log on to the remote and start carla, by running `./CarlaUE4.sh -carla-rpc-port=<port-you-choose> -RenderOffScreen` in the unzipped carla directory.
2. Spin up the environment running `docker compose up -d`. When doing this for the first time, this will build all the containers, which might take some time.
3. Use `docker compose logs --follow <service-name>` to access the logs (hit tab twice for auto-complete)
4. Use `docker compose restart <service-name>` to restart a specific service.
5. Use `docker compose down` to stop the environment. 
6. Use `docker compose build` to force a rebuild.
7. Please find some tutorial on docker compose if you want to learn more.
8. You cann see the frontend on `localhost:<frontend-port-you-chose>` (it might load slow on the first visit, so be sure to wait for up to a minute).

> NOTE: During development, you might have to restart some services. Remember to restart carla on
> the remote (kill it with CTRL+C, then start it again) also, when you do that, to avoid traffic
> being generated twice.